<!--
Label Studio Template: Translation Review (Round 3)
Task: Review segment audio + transcript + translation together

Pipeline Stage: TRANSLATED â†’ TRANSLATION_REVIEW â†’ (ready for DENOISED)

Interface:
- Segment audio player
- Source transcript (code-switched)
- Gemini translation
- Editable corrected translation
- Quality assessment

Schema Version: 3.0
-->
<View>
  <Header value="ðŸŒ Translation Review (Round 3)"/>
  
  <!-- Metadata Display -->
  <View style="display: flex; gap: 20px; margin-bottom: 15px; padding: 10px; background: #e8f4f8; border-radius: 8px;">
    <View>
      <Header value="Video ID" size="5"/>
      <Text name="video_id_display" value="$external_id"/>
    </View>
    <View>
      <Header value="Segment" size="5"/>
      <Text name="segment_index_display" value="$segment_index"/>
    </View>
    <View>
      <Header value="Duration" size="5"/>
      <Text name="duration_display" value="$duration_seconds"/>
    </View>
  </View>
  
  <!-- Audio Player -->
  <View style="padding: 10px; background: #f5f5f5; border-radius: 8px; margin-bottom: 15px;">
    <Header value="ðŸŽ§ Segment Audio" size="4"/>
    <Audio name="audio" value="$audio" hotkey="space"/>
  </View>
  
  <!-- Instructions -->
  <View style="background: #d4edda; padding: 10px; border-radius: 8px; margin-bottom: 15px;">
    <Header value="ðŸ“‹ Instructions" size="4"/>
    <Text name="instructions" value="Verify audio â†” transcript â†” translation alignment:"/>
    <View style="margin-left: 20px;">
      <Text value="âœ… Listen to audio and verify transcript matches"/>
      <Text value="âœ… Check that translation captures the meaning"/>
      <Text value="âœ… Correct any translation errors"/>
      <Text value="âœ… Ensure natural Vietnamese phrasing"/>
    </View>
  </View>
  
  <!-- Side-by-side View -->
  <View style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
    
    <!-- Source Text (CS Vietnamese-English) -->
    <View style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
      <Header value="ðŸ“ Source Transcript (Code-Switched)" size="4"/>
      <View style="border-left: 4px solid #1976d2; padding-left: 10px; background: #fff; padding: 10px; border-radius: 4px;">
        <Text name="source_text_display" value="$source_text"/>
      </View>
    </View>
    
    <!-- Gemini Translation (Reference) -->
    <View style="background: #fff3e0; padding: 15px; border-radius: 8px;">
      <Header value="ðŸ¤– Gemini Translation (Draft)" size="4"/>
      <View style="border-left: 4px solid #ff9800; padding-left: 10px; background: #fff; padding: 10px; border-radius: 4px;">
        <Text name="gemini_translation_display" value="$translation_text"/>
      </View>
    </View>
  </View>
  
  <!-- Corrected Translation Input -->
  <View style="margin-bottom: 15px;">
    <Header value="âœï¸ Corrected Translation (Vietnamese)" size="4"/>
    <TextArea name="corrected_translation" 
              toName="audio"
              value="$translation_text"
              rows="4"
              placeholder="Enter corrected Vietnamese translation..."
              maxSubmissions="1"
              editable="true"/>
  </View>
  
  <!-- Audio-Transcript Match -->
  <View style="margin-bottom: 15px;">
    <Header value="ðŸŽ¯ Audio-Transcript Match" size="4"/>
    <Choices name="audio_transcript_match" toName="audio" choice="single" required="true">
      <Choice value="perfect_match" hint="Audio exactly matches transcript"/>
      <Choice value="minor_differences" hint="Small differences, acceptable"/>
      <Choice value="significant_mismatch" hint="Transcript doesn't match audio"/>
    </Choices>
  </View>
  
  <!-- Translation Quality Assessment -->
  <View style="margin-bottom: 15px;">
    <Header value="ðŸ·ï¸ Translation Issues" size="4"/>
    <Choices name="translation_issues" toName="audio" choice="multiple">
      <Choice value="meaning_error" hint="Translation doesn't capture original meaning"/>
      <Choice value="grammar_error" hint="Vietnamese grammar issues"/>
      <Choice value="unnatural_phrasing" hint="Awkward or unnatural Vietnamese"/>
      <Choice value="missing_content" hint="Some content not translated"/>
      <Choice value="over_translation" hint="Added content not in original"/>
      <Choice value="term_handling" hint="English terms handled incorrectly"/>
      <Choice value="context_lost" hint="Context from adjacent segments lost"/>
    </Choices>
  </View>
  
  <!-- Overall Quality Rating -->
  <View style="display: flex; gap: 30px; margin-bottom: 15px;">
    <View>
      <Header value="â­ Gemini Translation Quality" size="4"/>
      <Rating name="mt_quality" toName="audio" maxRating="5" icon="star" size="medium"/>
    </View>
    <View>
      <Header value="â­ Confidence in Final Translation" size="4"/>
      <Rating name="confidence" toName="audio" maxRating="5" icon="star" size="medium"/>
    </View>
  </View>
  
  <!-- Final Decision -->
  <View style="margin-bottom: 15px;">
    <Header value="âœ… Final Decision" size="4"/>
    <Choices name="final_decision" toName="audio" choice="single" required="true">
      <Choice value="approve" hint="Segment is good, ready for training"/>
      <Choice value="needs_revision" hint="Send back for re-translation"/>
      <Choice value="reject" hint="Segment should be excluded"/>
    </Choices>
  </View>
  
  <!-- Notes -->
  <View>
    <Header value="ðŸ“ Notes" size="4"/>
    <TextArea name="notes" 
              toName="audio"
              rows="2"
              placeholder="Any notes about this translation..."/>
  </View>
</View>
