# Dockerfile.ingest
# Base image: Official Python 3.10 Slim (lightweight)
FROM python:3.10-slim

# 1. Install System Dependencies (FFmpeg is crucial for audio processing)
RUN apt-get update && apt-get install -y \
    ffmpeg \
    git \
    && rm -rf /var/lib/apt/lists/*

# 2. Set Working Directory
WORKDIR /app

# 3. Install Python Dependencies
# - yt-dlp: For downloading YouTube videos
# - youtube-transcript-api: For downloading transcripts
# - psycopg2-binary: For connecting to Postgres
# - dvc[gdrive]: For version control (if running DVC inside container)
# - google-generativeai: For Gemini transcription/translation
# - pydub: For audio processing and chunking
RUN pip install --no-cache-dir \
    yt-dlp \
    youtube-transcript-api \
    psycopg2-binary \
    dvc[gdrive] \
    google-generativeai>=0.3.0 \
    pydub

# 4. Copy your actual code (we will do this via volume mount in dev, but good for prod)
# COPY . .

# 5. Default command (keeps container alive for testing)
CMD ["tail", "-f", "/dev/null"]